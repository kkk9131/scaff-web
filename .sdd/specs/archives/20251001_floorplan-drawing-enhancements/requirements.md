# 要件定義書

## 機能概要
建物形状エディタの立面図体験を拡張するため、サイドバーに屋根設定セクションを追加し、屋根タイプ・勾配・最高高さ・軒の出を一括管理できるようにする。また立面図上で軒の出や高さの寸法線を可視化し、階層ごとの表示制御（重なり抑止、寸法表示のON/OFF切り替え）を提供して意思決定に必要な図面情報を強化する。

## ユーザーストーリー
- 足場計画担当者として、屋根条件や軒の出をサイドバーで設定し、立面図に即時反映させたい。なぜなら関係者と図面条件をすり合わせる際に数値と視覚情報を同時に確認したいから。

## 機能要件
### 要件1：屋根設定セクションの追加
- サイドバー内に「屋根」セクションを新設し、屋根タイプ（切妻・寄棟・片流れ・フラット）を選択できるラジオ（または同等のUI）と、屋根勾配値・最高高さを入力できるフォームを提供する。軒の出を階層ごとに設定・表示できるようにし、既存の階層管理と連携させる。
- 受入基準：
  - [ ] サイドバーに「屋根」セクションが表示され、開閉操作が既存セクションと同様に動作すること
  - [ ] 選択した屋根タイプ・入力した勾配/最高高さ/軒の出が `BuildingProvider` の状態へ保存され、アプリ再訪時にも復元されること
  - [ ] 各階層に対して軒の出を個別に設定でき、ロックされた階層では編集できないこと

### 要件2：立面図への軒ライン・寸法表示
- 立面図ビューで軒の出を基準輪郭から点線（例：破線）として描画し、壁面と重なる場合は該当区間の線を省略する。各立面に階高と軒の出の寸法線およびラベル（mm単位）を追加し、屋根勾配（例：`10/5`）を明示する。
- 受入基準：
  - [ ] サイドバーで軒の出を設定すると、各方向の立面図に対応する軒ラインが点線で表示されること
  - [ ] 軒ラインが壁面より外側に存在する区間のみ描画され、壁と重なる区間が描かれないこと
  - [ ] 立面図に階層ごとの高さ寸法線、軒の出寸法値、屋根勾配ラベルが表示されること
  - [ ] 設定内容を変えると立面図の該当表示が即時更新されること

### 要件3：寸法表示トグル
- 立面図の寸法表示（高さ・軒の出・勾配ラベル）をユーザーがON/OFFできる操作を提供し、平面図の寸法表示モードと干渉しないよう独立した制御とする。
- 受入基準：
  - [ ] サイドバーまたは立面図ビュー内に寸法表示を切り替えるUIが存在し、状態が視覚的に把握できること
  - [ ] OFFの状態では立面図の寸法線・寸法値・勾配ラベルが非表示になること
  - [ ] 切り替え状態が `BuildingProvider` に保持され、画面遷移や再描画時にも維持されること

## 非機能要件
- パフォーマンス：立面図レンダリングを更新してもブラウザで目立つ遅延やフレーム落ちを発生させないこと（既存表示と同等の応答性を維持）。
- セキュリティ：ローカルストレージへ保存する値は屋根設定・寸法情報のみとし、個人情報や資格情報を扱わないこと。
