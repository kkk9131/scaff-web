# 実装タスクリスト

## セクション1：データモデル実装
- [x] 1.1 必要な型定義・データ構造を作成する
  - design.mdで定義された`FloorplanTemplate`、`FloorplanShape`、`ConstraintState`、`Point`型を追加
  - テンプレート寸法バリデーションや軒設定の型ガードを用意
- [x] 1.2 データ永続化層を実装する
  - `TemplateCatalog`モジュールにテンプレート定義を実装し、スケール変換用ヘルパーを含める
  - `FloorplanContext`にテンプレート適用と制約設定の状態を保持するリデューサー・アクションを追加

## セクション2：ビジネスロジック実装
- [x] 2.1 TemplateSidebarSectionのコア処理を実装する
  - design.mdの処理フロー1-2に対応するテンプレート取得・適用ハンドラを実装
- [x] 2.2 EaveLineRendererの処理を実装する
  - design.mdの処理フロー3に対応し、軒ライン延長と階層カラー適用ロジックを追加
- [x] 2.3 CanvasConstraintControllerの処理を実装する
  - design.mdの処理フロー4-5に対応し、直角制御・グリッドスナップ・同期イベントを実装

## セクション3：インターフェース実装
- [x] 3.1 UIコンポーネント/APIエンドポイントを作成する
  - `TemplateSidebarSection`コンポーネントを実装し、`FloorSettingsPanel`へ統合
- [x] 3.2 入力バリデーションを実装する
  - テンプレート選択時の寸法バリデーションと失敗時の通知処理を追加
- [x] 3.3 出力フォーマットを実装する
  - コンテキスト更新を3Dビュー・図面出力へ反映させる既存イベントの呼び出しを確実化

## セクション4：統合とテスト
- [x] 4.1 コンポーネントを統合する
  - 新モジュールを既存Konvaキャンバスとサイドバーに接続し、状態フローを確認
- [x] 4.2 基本的な動作テストを実装する
  - TemplateCatalogユニットテストとCanvasConstraintControllerのロジックテストを追加
  - TemplateSidebarSectionの簡易レンダリングテストを追加
- [x] 4.3 要件の受入基準を満たすことを確認する
  - テンプレート適用、軒ライン描画、直角・グリッド動作が要件チェックリストを満たすことを検証
